# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
  - master # disable CI build for branch except master
# pr:
#   - master # only kick off for pr targeting master

jobs:
  - job: MyJob
    displayName: My First Job
    # workspace:
    #   clean: outputs

    # cancelTimeoutInMinutes: 1
    # timeoutInMinutes: 1 # check whether works w > 60?

    strategy:
      matrix:
        linux:
          imageName: 'ubuntu-16.04'
        mac:
          imageName: 'macos-10.13'

    pool:
      vmImage: $(imageName)
      # vmImage: 'Ubuntu-16.04'
      # BUG: `timeoutInMinutes` accepted under pool but has no effect

    steps:
    - checkout: self # self represents the repo where the initial Pipelines YAML file was found
      fetchDepth: 1
    # - template: azure-pipelines/linux/continuous-build-linux.yml

    - script: echo Hello, world!
      displayName: 'Run a one-line script'

    - script: |
        set -e
        echo "v1"
        echo Add other tasks to build, test, and deploy your project.
        echo See https://aka.ms/yaml
        echo "ok1"
        echo "##vso[task.logissue type=error;sourcepath=consoleapp/main.cs;linenumber=1;columnnumber=1;code=100;]this is an error"

        echo "##vso[task.logissue type=warning;sourcepath=consoleapp/main.cs;linenumber=1;columnnumber=1;code=100;]this is an error2"
        echo "##vso[task.complete result=Succeeded;]DONE"

        # git log | cat
        sleep 240
        echo "ok2"
      displayName: 'Run a multi-line script'
      # enabled: false
      # timeoutInMinutes: 1

